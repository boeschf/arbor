#!/bin/bash -l

#SBATCH --job-name=#BENCHNAME#
#SBATCH --account=csstaff
#SBATCH --constraint=gpu
#SBATCH --partition=normal
#SBATCH --time=02:59:00
#SBATCH --nodes=#NODES#
#SBATCH --ntasks-per-node=1
#SBATCH --ntasks-per-socket=1
#SBATCH --cpus-per-task=12
#SBATCH --ntasks-per-core=1
#SBATCH --hint=nomultithread

module load daint-gpu/21.09
module load craype-accel-nvidia60
module switch cudatoolkit cudatoolkit/21.5_11.3
module rm PrgEnv-cray
module load PrgEnv-gnu
module switch gcc gcc/9.3.0
module load cray-python/3.9.4.1
module unload xalt

## for large jobs
#export PMI_MMAP_SYNC_WAIT_TIME=300

export MPICH_MAX_THREAD_SAFETY=multiple
export MPICH_GNI_NDREG_ENTRIES=1024
export CRAY_CUDA_MPS=1
export MPICH_RDMA_ENABLED_CUDA=1
export MPICH_G2G_PIPELINE=30

